\section{RP9 Session}
\label{sec:principle-rp9-session}

Die Session sollte ausschliesslich für simple Authentifizierungsinformationen gebraucht werden. Dabei wird z.B. eine eindeutige Session-ID generiert, mit welcher der angemeldete User eindeutig erkennt werden kann. Dies reicht für die wiederholte Authentifizierung vollkommen aus.

\subsection*{Geplante Umsetzung}
Die Session ist kein Datenspeicher, aus diesen Grund sollen keine Datensätze oder Seitenvariablen darin gespeichert werden.

Es sollen nur benötigte Logindaten mittels Session übermittelt werden.

\subsection*{Konkrete Umsetzung}
Passport.js \cite{Passportjs}, die verwendete Bibliothek für die Authentifikation der User (siehe Abschnitt \ref{sec:principle-tp4-seperate-user-identity} ``\nameref{sec:principle-tp4-seperate-user-identity}'') speichert beim Anmelden die Benutzerdaten serialisiert in die Session. Ab diesen Punkt hat man solange der User angemeldet ist Zugriff auf seine Informationen.

Die Anwendung der Session wurde nicht nur für Authentifikationsdaten gebraucht. Temporäre Daten die vom Server benötigt werden, wurden ebenfalls in die Session gespeichert. Hauptsächlich ging es darum die Benutzerfreundlichkeit zu erhöhen. Konkret wurde es in der Beispielapplikation benutzt, um den Benutzer nach einem Login an die gewünschte Seite zu weiterleiten.

\begin{quotation}
Ein Benutzer von ``Roomies'' liebt es, sich mit den anderen Mitbewohner zu vergleichen. Deswegen besucht er oft die Rangliste. Auch einen Favorit hat er auf die Seite gesetzt, damit er direkt auf der Rangliste landet.

Ist der Benutzer noch nicht angemeldet und möchte die Rangliste besuchen wird er vom System aufgefordert sich anzumelden. Nach dem Anmeldevorgang wird ihm wie gewünscht jene Seite gezeigt.
\end{quotation}

Das Weiterleiten auf die Rangliste ist nur möglich, weil der Server die \gls{URL} vor dem Login in die Session speichert (siehe Quelltext \ref{lst:router-set-redirecturl}).

\begin{lstlisting}[language=JavaScript, caption=Router - Autorisationskontrolle \cite{roomiesRouter}, label=lst:router-set-redirecturl, firstnumber=225]

/** Function: redirectIfNotAuthorized
 * If the client is not authorized it will redirect. Otherwise it returns
 * false to indicate that the calling method can continue work.
 */
, redirectIfNotAuthorized: function redirectIfNotAuthorized() {
	if(!this.isAuthorized()) {
		var req = this.apiAdapter.req;
		req.session.redirectUrl = req.originalUrl;
		this.navigate('', {trigger: true});
		return true;
	}
	return false;
}
\end{lstlisting}

Nur so ist es möglich den Benutzer nach dem Anmelden an die ursprünglich aufgerufene Seite weiterzuleiten. Wäre diese \gls{URL} nicht zwischengespeichert würde das System dem Benutzer an eine fix definierte Seite weiterleiten, was der Benutzerfreundlichkeit Schaden würde.

\subsection*{Diskussion}
